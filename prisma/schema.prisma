generator client {
  provider = "postgresql"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URLpostgresql://postgres:[YOUR-PASSWORD]@db.kwshufyveojvxbwbcjsa.supabase.co:5432/postgres")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  role      String   @default("USER") // USER, ADMIN
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  orders    Order[]
}

model Product {
  id          String      @id @default(cuid())
  name        String
  description String
  price       Decimal
  images      String // JSON string or comma separated
  category    String
  inventory   Int         @default(0)
  podStatus   Boolean     @default(true) // Printed on demand
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  orderItems  OrderItem[]
}

model Order {
  id              String      @id @default(cuid())
  userId          String?
  user            User?       @relation(fields: [userId], references: [id])
  total           Decimal
  status          String      @default("PENDING") // PENDING, PROCESSING, SHIPPED, DELIVERED
  shippingAddress String // JSON
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
  items           OrderItem[]
}

model OrderItem {
  id              String  @id @default(cuid())
  orderId         String
  order           Order   @relation(fields: [orderId], references: [id])
  productId       String
  product         Product @relation(fields: [productId], references: [id])
  quantity        Int
  priceAtPurchase Decimal
}

model Coupon {
  id            String   @id @default(cuid())
  code          String   @unique
  discountType  String // PERCENTAGE, FIXED
  discountValue Decimal
  expiry        DateTime?
  isActive      Boolean  @default(true)
}
